$(window).on("load",(function(){$("#preloader").length&&$("#preloader").delay(1e3).fadeOut("slow",(function(){$(this).remove()}))})),$((function(){$(".tab-link").on("shown.bs.tab",(function(t){localStorage.setItem("lastTab",$(this).attr("data-bs-target"))}));var t=localStorage.getItem("lastTab");t&&$('[data-bs-target="'+t+'"]').tab("show")})),$("#addEmployeeModal").on("hidden.bs.modal",(function(){$(this).find("form").trigger("reset")})),$("#addDepartmentModal").on("hidden.bs.modal",(function(){$(this).find("form").trigger("reset")})),$("#addLocationModal").on("hidden.bs.modal",(function(){$(this).find("form").trigger("reset")})),$("#editEmployeeModal").on("show.bs.modal",(function(t){$("#big-delete-btn-emp").attr("value",$(t.relatedTarget).data("id")),$("#idEdit").attr("value",$(t.relatedTarget).data("id")),$("#firstFieldEdit").attr("value",$(t.relatedTarget).data("first")),$("#lastFieldEdit").attr("value",$(t.relatedTarget).data("last")),$("#emailFieldEdit").attr("value",$(t.relatedTarget).data("email")),$("#jobFieldEdit").attr("value",$(t.relatedTarget).data("job")),$("#departmentFieldEdit").val($(t.relatedTarget).data("dept-id")),$("#locationFieldEdit").val($(t.relatedTarget).data("location"))})),$("#editEmployeeModal").on("hidden.bs.modal",(function(){$(this).find("form").trigger("reset")})),$("#editDepartmentModal").on("show.bs.modal",(function(t){$("#deptIdEdit").attr("value",$(t.relatedTarget).data("id")),$("#deptNameFieldEdit").attr("value",$(t.relatedTarget).data("department")),$("#deptLocationFieldEdit").val($(t.relatedTarget).data("location"))})),$("#editDepartmentModal").on("hidden.bs.modal",(function(){$(this).find("form").trigger("reset")})),$("#editLocationModal").on("show.bs.modal",(function(t){$("#locationIdEdit").attr("value",$(t.relatedTarget).data("id")),$("#locationNameFieldEdit").attr("value",$(t.relatedTarget).data("location"))})),$("#editLocationModal").on("hidden.bs.modal",(function(){$(this).find("form").trigger("reset")})),$("#deleteEmployeeModal").on("show.bs.modal",(function(t){$("#idDel").attr("value",$(t.relatedTarget).data("id")),$("#idDel").attr("value",$(t.relatedTarget).data("id")),$("#fullName").text($(t.relatedTarget).data("first")+" "+$(t.relatedTarget).data("last"))})),$("#deleteDepartmentModal").on("show.bs.modal",(function(t){$("#deptIdDel").attr("value",$(t.relatedTarget).data("id")),$("#deptNameDel").text($(t.relatedTarget).data("department")),$("#deptNameError").text($(t.relatedTarget).data("department"));var e=$(t.relatedTarget).data("id");$.ajax({url:"libs/php/getPersonnelCount.php",type:"POST",dataType:"json",async:!1,data:{id:e},success:function(e){0!=e.data.personnel[0].pc&&($("#errorDepartmentModal").modal("show"),t.preventDefault())},error:function(t,e,a){}})})),$("#deleteLocationModal").on("show.bs.modal",(function(t){$("#locationIdDel").attr("value",$(t.relatedTarget).data("id")),$("#locNameDel").text($(t.relatedTarget).data("location")),$("#locNameError").text($(t.relatedTarget).data("location")),val=$(t.relatedTarget).data("id"),$.ajax({url:"libs/php/getDepartmentCount.php",type:"POST",dataType:"json",async:!1,data:{id:val},success:function(e){0!=e.data.department[0].dc&&($("#errorLocationModal").modal("show"),t.preventDefault())},error:function(t,e,a){}})}));let table=document.getElementById("employeesTable");function removeAllChildNodes(t){for(;t.firstChild;)t.removeChild(t.firstChild)}const getAll=function(){$.ajax({url:"libs/php/getAll.php",type:"POST",dataType:"json",success:function(t){const e=t.data;let a=document.createDocumentFragment(),d=document.createElement("tbody");a.appendChild(d),e.forEach((t=>{d.insertAdjacentHTML("beforeend",`<tr title="Edit" data-bs-toggle="modal" data-id="${t.id}" data-first="${t.firstName}" data-last="${t.lastName}" data-email="${t.email}" data-job="${""===t.jobTitle?"null":t.jobTitle}" data-dept-id="${t.deptID}" data-location="${t.locationID}" data-bs-target="#editEmployeeModal">\n          <td>${t.lastName}</td>\n          <td>${t.firstName}</td>\n          <td class="d-none d-md-table-cell">${t.jobTitle}</td>\n          <td class="d-none d-md-table-cell">${t.email}</td>\n          <td class="d-none d-md-table-cell">${t.dept}</td>\n          <td class="d-none d-lg-table-cell">${t.location}</td>\n\n          <td>\n            <a href="#deleteEmployeeModal" class="delete" data-id="${t.id}" data-first="${t.firstName}" data-last="${t.lastName}" data-bs-toggle="modal">\n              <i class="fas fa-trash-alt" data-bs-toggle="tooltip" title="Delete"></i>\n            </a>\n          </td>\n          </tr>`)})),table.appendChild(a);const n=$("#mainNav").outerHeight()+$("#navTabs").outerHeight();var o=$("#employeesTable").DataTable({paging:!1,autoWidth:!0,sDom:"ltipr",fixedHeader:{header:!1,headerOffset:n},columnDefs:[{targets:[6],orderable:!1}],bInfo:!1});o.columns().iterator("column",(function(t,e){$(o.column(e).header()).append('<span class="sort-icon"/>')})),$("#myInput").on("keyup change",(function(){o.search(this.value).draw()}))},error:function(t,e,a){}})};$.ajax({url:"libs/php/getAll.php",type:"POST",dataType:"json",success:function(t){const e=t.data;let a=document.createDocumentFragment(),d=document.createElement("tbody");a.appendChild(d),e.forEach((t=>{d.insertAdjacentHTML("beforeend",`<tr title="Edit" data-bs-toggle="modal" data-id="${t.id}" data-first="${t.firstName}" data-last="${t.lastName}" data-email="${t.email}" data-job="${""===t.jobTitle?"null":t.jobTitle}" data-dept-id="${t.deptID}" data-location="${t.locationID}" data-bs-target="#editEmployeeModal">\n          <td>${t.lastName}</td>\n          <td>${t.firstName}</td>\n          <td class="d-none d-md-table-cell">${t.jobTitle}</td>\n          <td class="d-none d-md-table-cell">${t.email}</td>\n          <td class="d-none d-md-table-cell">${t.dept}</td>\n          <td class="d-none d-lg-table-cell">${t.location}</td>\n\n          <td>\n            <a href="#deleteEmployeeModal" class="delete" data-id="${t.id}" data-first="${t.firstName}" data-last="${t.lastName}" data-bs-toggle="modal">\n              <i class="fas fa-trash-alt" data-bs-toggle="tooltip" title="Delete"></i>\n            </a>\n          </td>\n          </tr>`)})),table.appendChild(a);const n=$("#mainNav").outerHeight()+$("#navTabs").outerHeight();var o=$("#employeesTable").DataTable({paging:!1,autoWidth:!0,sDom:"ltipr",fixedHeader:{header:!1,headerOffset:n},columnDefs:[{targets:[6],orderable:!1}],bInfo:!1});o.columns().iterator("column",(function(t,e){$(o.column(e).header()).append('<span class="sort-icon"/>')})),$("#myInput").on("keyup change",(function(){o.search(this.value).draw()}))},error:function(t,e,a){}});const getAllDepartments=function(){$.ajax({url:"libs/php/getAllDepartments.php",type:"POST",dataType:"json",success:function(t){const e=t.data;let a=document.getElementById("departmentsTable"),d=document.createDocumentFragment(),n=document.createElement("tbody");d.appendChild(n),e.forEach((t=>{$("#departmentField").append(new Option(t.department,t.departmentID)),$("#departmentFieldEdit").append(new Option(t.department,t.departmentID)),n.insertAdjacentHTML("beforeend",`<tr title="Edit" data-bs-toggle="modal" data-id="${t.departmentID}" data-department="${t.department}" data-location="${t.locationID}" data-bs-target="#editDepartmentModal">\n            <td>${t.department}</td>\n            <td>${t.location}</td>\n            <td>\n              <a href="#deleteDepartmentModal" class="delete deleteDept" data-id="${t.departmentID}" data-department="${t.department}" data-bs-toggle="modal">\n                <i class="fas fa-trash-alt" data-toggle="tooltip" title="Delete"></i>\n              </a>\n            </td>\n          </tr>`)}));var o=$("#departmentField"),l=o.val(),i=o.find("option");i.sort((function(t,e){return $(t).text()>$(e).text()?1:-1})),o.html("").append(i),o.val(l);var r=$("#departmentFieldEdit"),s=r.val(),p=r.find("option");p.sort((function(t,e){return $(t).text()>$(e).text()?1:-1})),r.html("").append(p),r.val(s),$("#departmentField").prepend(new Option("Department","department")),$("option[value='department']").attr("disabled","disabled"),$("option[value='department']").attr("selected","selected"),a.appendChild(d);var c=$("#departmentsTable").DataTable({paging:!1,autoWidth:!0,fixedHeader:{header:!1,headerOffset:92},sDom:"ltipr",columnDefs:[{targets:[2],orderable:!1}],bInfo:!1});c.columns().iterator("column",(function(t,e){$(c.column(e).header()).append('<span class="sort-icon"/>')})),$("#myInput").on("keyup change",(function(){c.search(this.value).draw()}))},error:function(t,e,a){}})};$.ajax({url:"libs/php/getAllDepartments.php",type:"POST",dataType:"json",success:function(t){const e=t.data;let a=document.getElementById("departmentsTable"),d=document.createDocumentFragment(),n=document.createElement("tbody");d.appendChild(n),e.forEach((t=>{$("#departmentField").append(new Option(t.department,t.departmentID)),$("#departmentFieldEdit").append(new Option(t.department,t.departmentID)),n.insertAdjacentHTML("beforeend",`<tr title="Edit" data-bs-toggle="modal" data-id="${t.departmentID}" data-department="${t.department}" data-location="${t.locationID}" data-bs-target="#editDepartmentModal">\n            <td>${t.department}</td>\n            <td>${t.location}</td>\n            <td>\n              <a href="#deleteDepartmentModal" class="delete deleteDept" data-id="${t.departmentID}" data-department="${t.department}" data-bs-toggle="modal">\n                <i class="fas fa-trash-alt" data-toggle="tooltip" title="Delete"></i>\n              </a>\n            </td>\n          </tr>`)}));var o=$("#departmentField"),l=o.val(),i=o.find("option");i.sort((function(t,e){return $(t).text()>$(e).text()?1:-1})),o.html("").append(i),o.val(l);var r=$("#departmentFieldEdit"),s=r.val(),p=r.find("option");p.sort((function(t,e){return $(t).text()>$(e).text()?1:-1})),r.html("").append(p),r.val(s),$("#departmentField").prepend(new Option("Department","department")),$("option[value='department']").attr("disabled","disabled"),$("option[value='department']").attr("selected","selected"),a.appendChild(d);var c=$("#departmentsTable").DataTable({paging:!1,autoWidth:!0,fixedHeader:{header:!1,headerOffset:92},sDom:"ltipr",columnDefs:[{targets:[2],orderable:!1}],bInfo:!1});c.columns().iterator("column",(function(t,e){$(c.column(e).header()).append('<span class="sort-icon"/>')})),$("#myInput").on("keyup change",(function(){c.search(this.value).draw()}))},error:function(t,e,a){}});const changeTab=function(t){$(`#${t}-tab`).trigger("click")},getAllLocations=function(){$.ajax({url:"libs/php/getAllLocations.php",type:"POST",dataType:"json",success:function(t){const e=t.data;let a=document.getElementById("locationsTable"),d=document.createDocumentFragment(),n=document.createElement("tbody");d.appendChild(n),e.forEach((t=>{$("#locationField").append(new Option(t.name,t.id)),$("#locationFieldEdit").append(new Option(t.name,t.id)),$("#deptLocationFieldEdit").append(new Option(t.name,t.id)),n.insertAdjacentHTML("beforeend",`<tr title="Edit" data-bs-toggle="modal" data-id="${t.id}" data-location="${t.name}" data-bs-target="#editLocationModal">\n        <td>${t.name}</td>\n        <td>\n          <a href="#deleteLocationModal" class="delete" data-id="${t.id}" data-location="${t.name}" data-bs-toggle="modal">\n            <i class="fas fa-trash-alt" data-bs-toggle="tooltip" title="Delete"></i>\n          </a>\n        </td>\n        </tr>`)}));var o=$("#locationField"),l=o.val(),i=o.find("option");i.sort((function(t,e){return $(t).text()>$(e).text()?1:-1})),o.html("").append(i),o.val(l);var r=$("#locationFieldEdit"),s=r.val(),p=r.find("option");p.sort((function(t,e){return $(t).text()>$(e).text()?1:-1})),r.html("").append(p),r.val(s);var c=$("#deptLocationFieldEdit"),m=c.val(),u=c.find("option");u.sort((function(t,e){return $(t).text()>$(e).text()?1:-1})),c.html("").append(u),c.val(m),$("#locationField").prepend(new Option("Location","location")),$("option[value='location']").attr("disabled","disabled"),$("option[value='location']").attr("selected","selected"),a.appendChild(d);var f=$("#locationsTable").DataTable({paging:!1,autoWidth:!0,fixedHeader:{header:!1,headerOffset:0},sDom:"ltipr",columnDefs:[{targets:[1],orderable:!1}],bInfo:!1});f.columns().iterator("column",(function(t,e){$(f.column(e).header()).append('<span class="sort-icon"/>')})),$("#myInput").on("keyup change",(function(){f.search(this.value).draw()}))},error:function(t,e,a){}})};$.ajax({url:"libs/php/getAllLocations.php",type:"POST",dataType:"json",success:function(t){const e=t.data;let a=document.getElementById("locationsTable"),d=document.createDocumentFragment(),n=document.createElement("tbody");d.appendChild(n),e.forEach((t=>{$("#locationField").append(new Option(t.name,t.id)),$("#locationFieldEdit").append(new Option(t.name,t.id)),$("#deptLocationFieldEdit").append(new Option(t.name,t.id)),n.insertAdjacentHTML("beforeend",`<tr title="Edit" data-bs-toggle="modal" data-id="${t.id}" data-location="${t.name}" data-bs-target="#editLocationModal">\n        <td>${t.name}</td>\n        <td>\n          <a href="#deleteLocationModal" class="delete" data-id="${t.id}" data-location="${t.name}" data-bs-toggle="modal">\n            <i class="fas fa-trash-alt" data-bs-toggle="tooltip" title="Delete"></i>\n          </a>\n        </td>\n        </tr>`)}));var o=$("#locationField"),l=o.val(),i=o.find("option");i.sort((function(t,e){return $(t).text()>$(e).text()?1:-1})),o.html("").append(i),o.val(l);var r=$("#locationFieldEdit"),s=r.val(),p=r.find("option");p.sort((function(t,e){return $(t).text()>$(e).text()?1:-1})),r.html("").append(p),r.val(s);var c=$("#deptLocationFieldEdit"),m=c.val(),u=c.find("option");u.sort((function(t,e){return $(t).text()>$(e).text()?1:-1})),c.html("").append(u),c.val(m),$("#locationField").prepend(new Option("Location","location")),$("option[value='location']").attr("disabled","disabled"),$("option[value='location']").attr("selected","selected"),a.appendChild(d);var f=$("#locationsTable").DataTable({paging:!1,autoWidth:!0,fixedHeader:{header:!1,headerOffset:0},sDom:"ltipr",columnDefs:[{targets:[1],orderable:!1}],bInfo:!1});f.columns().iterator("column",(function(t,e){$(f.column(e).header()).append('<span class="sort-icon"/>')})),$("#myInput").on("keyup change",(function(){f.search(this.value).draw()}))},error:function(t,e,a){}}),$("#editCheck").change((function(){this.checked?($("#employeeFieldset").prop("disabled",!1),$("#btn-update-emp").prop("disabled",!1)):($("#employeeFieldset").prop("disabled",!0),$("#btn-update-emp").prop("disabled",!0))})),$("#deptEditCheck").change((function(){this.checked?($("#departmentFieldset").prop("disabled",!1),$("#btn-update-dept").prop("disabled",!1)):($("#departmentFieldset").prop("disabled",!0),$("#btn-update-dept").prop("disabled",!0))})),$("#locationEditCheck").change((function(){this.checked?($("#locationFieldset").prop("disabled",!1),$("#btn-update-location").prop("disabled",!1)):($("#locationFieldset").prop("disabled",!0),$("#btn-update-location").prop("disabled",!0))}));const insertEmployee=function(){$.ajax({url:"libs/php/insertEmployee.php",type:"POST",dataType:"json",data:{firstName:$("#firstField").val(),lastName:$("#lastField").val(),jobTitle:$("#jobField").val(),email:$("#emailField").val(),departmentID:$("#departmentField").val()},success:function(t){"200"===t.status.code&&location.reload()},error:function(t,e,a){}})};$("#employee_form").submit((function(t){t.preventDefault(),window.confirm("Add Employee?")&&$.ajax({url:"libs/php/insertEmployee.php",type:"POST",dataType:"json",data:{firstName:$("#firstField").val(),lastName:$("#lastField").val(),jobTitle:$("#jobField").val(),email:$("#emailField").val(),departmentID:$("#departmentField").val()},success:function(t){"200"===t.status.code&&location.reload()},error:function(t,e,a){}})}));const updateEmployee=function(){$.ajax({url:"libs/php/updateEmployee.php",type:"POST",dataType:"json",data:{firstName:$("#firstFieldEdit").val(),lastName:$("#lastFieldEdit").val(),jobTitle:$("#jobFieldEdit").val(),email:$("#emailFieldEdit").val(),departmentID:$("#departmentFieldEdit").val(),id:$("#idEdit").val()},success:function(t){"200"===t.status.code&&location.reload()},error:function(t,e,a){}})};$("#employee_form_edit").submit((function(t){t.preventDefault(),window.confirm("Update Employee?")&&$.ajax({url:"libs/php/updateEmployee.php",type:"POST",dataType:"json",data:{firstName:$("#firstFieldEdit").val(),lastName:$("#lastFieldEdit").val(),jobTitle:$("#jobFieldEdit").val(),email:$("#emailFieldEdit").val(),departmentID:$("#departmentFieldEdit").val(),id:$("#idEdit").val()},success:function(t){"200"===t.status.code&&location.reload()},error:function(t,e,a){}})}));const deleteEmployee=function(){$.ajax({url:"libs/php/deleteEmployee.php",type:"POST",dataType:"json",data:{id:$("#idDel").val()},success:function(t){"200"===t.status.code&&location.reload()},error:function(t,e,a){}})};$("#employee_form_delete").submit((function(t){t.preventDefault(),$.ajax({url:"libs/php/deleteEmployee.php",type:"POST",dataType:"json",data:{id:$("#idDel").val()},success:function(t){"200"===t.status.code&&location.reload()},error:function(t,e,a){}})}));const insertDepartment=function(){$.ajax({url:"libs/php/insertDepartment.php",type:"POST",dataType:"json",data:{name:$("#nameField").val(),locationID:$("#locationField").val()},success:function(t){"200"===t.status.code&&location.reload()},error:function(t,e,a){}})};$("#department_form").submit((function(t){t.preventDefault(),window.confirm("Add Department?")&&$.ajax({url:"libs/php/insertDepartment.php",type:"POST",dataType:"json",data:{name:$("#nameField").val(),locationID:$("#locationField").val()},success:function(t){"200"===t.status.code&&location.reload()},error:function(t,e,a){}})}));const updateDepartment=function(){$.ajax({url:"libs/php/updateDepartment.php",type:"POST",dataType:"json",data:{name:$("#deptNameFieldEdit").val(),locationID:$("#deptLocationFieldEdit").val(),id:$("#deptIdEdit").val()},success:function(t){"200"===t.status.code&&location.reload()},error:function(t,e,a){}})};$("#department_form_edit").submit((function(t){t.preventDefault(),window.confirm("Update Department?")&&$.ajax({url:"libs/php/updateDepartment.php",type:"POST",dataType:"json",data:{name:$("#deptNameFieldEdit").val(),locationID:$("#deptLocationFieldEdit").val(),id:$("#deptIdEdit").val()},success:function(t){"200"===t.status.code&&location.reload()},error:function(t,e,a){}})}));const deleteDepartment=function(){$.ajax({url:"libs/php/deleteDepartment.php",type:"POST",dataType:"json",data:{id:$("#deptIdDel").val()},success:function(t){const e=t.status;"200"===e.code&&(e.sql?alert(e.errormsg+"\n\n"+e.sql):location.reload())},error:function(t,e,a){}})};$("#department_form_delete").submit((function(t){t.preventDefault(),$.ajax({url:"libs/php/deleteDepartment.php",type:"POST",dataType:"json",data:{id:$("#deptIdDel").val()},success:function(t){const e=t.status;"200"===e.code&&(e.sql?alert(e.errormsg+"\n\n"+e.sql):location.reload())},error:function(t,e,a){}})}));const insertLocation=function(){$.ajax({url:"libs/php/insertLocation.php",type:"POST",dataType:"json",data:{name:$("#locationNameField").val()},success:function(t){"200"===t.status.code&&location.reload()},error:function(t,e,a){}})};$("#location_form").submit((function(t){t.preventDefault(),window.confirm("Add Location?")&&$.ajax({url:"libs/php/insertLocation.php",type:"POST",dataType:"json",data:{name:$("#locationNameField").val()},success:function(t){"200"===t.status.code&&location.reload()},error:function(t,e,a){}})}));const updateLocation=function(){$.ajax({url:"libs/php/updateLocation.php",type:"POST",dataType:"json",data:{name:$("#locationNameFieldEdit").val(),id:$("#locationIdEdit").val()},success:function(t){"200"===t.status.code&&location.reload()},error:function(t,e,a){}})};$("#location_form_edit").submit((function(t){t.preventDefault(),window.confirm("Update Location?")&&$.ajax({url:"libs/php/updateLocation.php",type:"POST",dataType:"json",data:{name:$("#locationNameFieldEdit").val(),id:$("#locationIdEdit").val()},success:function(t){"200"===t.status.code&&location.reload()},error:function(t,e,a){}})}));const deleteLocation=function(){$.ajax({url:"libs/php/deleteLocation.php",type:"POST",dataType:"json",data:{id:$("#locationIdDel").val()},success:function(t){const e=t.status;"200"===e.code&&(e.sql?alert(e.errormsg+"\n\n"+e.sql):location.reload())},error:function(t,e,a){}})};$("#location_form_delete").submit((function(t){t.preventDefault(),$.ajax({url:"libs/php/deleteLocation.php",type:"POST",dataType:"json",data:{id:$("#locationIdDel").val()},success:function(t){const e=t.status;"200"===e.code&&(e.sql?alert(e.errormsg+"\n\n"+e.sql):location.reload())},error:function(t,e,a){}})})),$(document).on("shown.bs.tab",'button[data-bs-toggle="tab"]',(function(t){var e=$(t.target),a=e.attr("data-bs-target");e.hasClass("active")&&("#locations"===a?($("#addButtonSm").attr("href","#addLocationModal"),$("#addButton").attr("href","#addLocationModal")):"#employees"===a?($("#addButtonSm").attr("href","#addEmployeeModal"),$("#addButton").attr("href","#addEmployeeModal"),$("#employeesTable").css("display","block")):"#departments"===a&&($("#addButtonSm").attr("href","#addDepartmentModal"),$("#addButton").attr("href","#addDepartmentModal"),$("#employeesTable").css("display","none")))}));