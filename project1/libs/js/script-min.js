let lat,lng,borderLayer,capital,countryAnthem;$(window).on("load",(function(){$("#preloader").length&&$("#preloader").delay(1e3).fadeOut("slow",(function(){$(this).remove()})),navigator.geolocation.getCurrentPosition(onSuccess,onError)}));const onSuccess=e=>{lat=e.coords.latitude,lng=e.coords.longitude,getCountryCode()},onError=e=>{};function ms2km(e){return Math.round(e/1e3*60*60)}function numberWithCommas(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}const replaceWhitespace=e=>e=e.replace(" ","_"),replaceWhitespace20=e=>e=e.replace(" ","%20");function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}$(document).ready((function(){$.ajax({url:"libs/php/getSelectOptions.php",type:"POST",dataType:"json",success:function(e){e.data.forEach((e=>$("#selCountry").append(new Option(e.name,e.code)))),$("#selCountry option[value='SO1']").remove()},error:function(e,t,a){}})}));const getCountryBorders=function(){$.ajax({url:"libs/php/getCountryBorders.php",type:"POST",dataType:"json",data:{countryCode:countryCode},success:function(e){let t=e.data;borderLayer&&borderLayer.remove();borderLayer=L.geoJson(t,{style:{color:"red",weight:1,fillColor:"red",fillOpacity:.1}}).addTo(map),map.fitBounds(borderLayer.getBounds().pad(.1))},error:function(e,t,a){}})};let POIs=L.markerClusterGroup({spiderfyOnMaxZoom:!1,showCoverageOnHover:!1,zoomToBoundsOnClick:!0,removeOutsideVisibleBounds:!0,maxClusterRadius:50,iconCreateFunction:function(e){var t=e.getChildCount(),a=" marker-cluster-";return a+=t<10?"small":t<100?"medium":"large",new L.DivIcon({html:"<div><span>"+t+"</span></div>",className:"POIs marker-cluster"+a,iconSize:new L.Point(40,40)})}});function getCities(){$.ajax({url:"libs/php/getCities.php",type:"POST",dataType:"json",data:{countryCode:countryCode},success:function(e){const t=e;let a={type:"FeatureCollection",features:[]};for(i=0;i<t.data.length;i++)a.features.push({type:"Feature",geometry:{type:"Point",coordinates:[t.data[i].lng,t.data[i].lat]},properties:{name:t.data[i].name,countryName:t.data[i].countryName}});a=a.features;var o=L.ExtraMarkers.icon({icon:"fa-city",extraClasses:"fa-2x",markerColor:"violet",shape:"circle",prefix:"fas",shadowSize:[0,0]});L.geoJSON(a,{onEachFeature:function(e,t){e.properties.name&&(t.bindPopup(e.properties.name),t.on("mouseover",(function(){t.openPopup()})),t.on("click",(function(){t.openPopup()})))},pointToLayer:function(e,t){return L.marker(t,{icon:o})}}).addTo(POIs)},error:function(e,t,a){}})}function getStadia(){$.ajax({url:"libs/php/getStadia.php",type:"POST",dataType:"json",data:{countryCode:countryCode},success:function(e){const t=e;let a={type:"FeatureCollection",features:[]};for(i=0;i<t.data.length;i++)a.features.push({type:"Feature",geometry:{type:"Point",coordinates:[t.data[i].lng,t.data[i].lat]},properties:{name:t.data[i].toponymName,countryName:t.data[i].countryName}});a=a.features;var o=L.ExtraMarkers.icon({icon:"fa-futbol",extraClasses:"fa-3x",markerColor:"red",shape:"circle",prefix:"fas",shadowSize:[0,0]});L.geoJSON(a,{onEachFeature:function(e,t){e.properties.name&&(t.bindPopup(e.properties.name),t.on("mouseover",(function(){t.openPopup()})),t.on("click",(function(){t.openPopup()})))},pointToLayer:function(e,t){return L.marker(t,{icon:o})}}).addTo(POIs)},error:function(e,t,a){}})}function getAirports(){$.ajax({url:"libs/php/getAirports.php",type:"POST",dataType:"json",data:{countryCode:countryCode},success:function(e){const t=e;let a={type:"FeatureCollection",features:[]};for(i=0;i<t.data.length;i++)a.features.push({type:"Feature",geometry:{type:"Point",coordinates:[t.data[i].lng,t.data[i].lat]},properties:{name:t.data[i].name,countryName:t.data[i].countryName}});a=a.features;var o=L.ExtraMarkers.icon({icon:"fa-plane",extraClasses:"fa-3x",markerColor:"pink",shape:"circle",prefix:"fas",shadowSize:[0,0]});L.geoJSON(a,{onEachFeature:function(e,t){e.properties.name&&(t.bindPopup(e.properties.name),t.on("mouseover",(function(){t.openPopup()})),t.on("click",(function(){t.openPopup()})))},pointToLayer:function(e,t){return L.marker(t,{icon:o})}}).addTo(POIs)},error:function(e,t,a){}})}function getParks(){$.ajax({url:"libs/php/getParks.php",type:"POST",dataType:"json",data:{countryCode:countryCode},success:function(e){const t=e;let a={type:"FeatureCollection",features:[]};for(i=0;i<t.data.length;i++)a.features.push({type:"Feature",geometry:{type:"Point",coordinates:[t.data[i].lng,t.data[i].lat]},properties:{name:t.data[i].toponymName,countryName:t.data[i].countryName}});a=a.features;var o=L.ExtraMarkers.icon({icon:"fa-tree",extraClasses:"fa-3x",markerColor:"green",shape:"circle",prefix:"fas",shadowSize:[0,0]});L.geoJSON(a,{onEachFeature:function(e,t){e.properties.name&&(t.bindPopup(e.properties.name),t.on("mouseover",(function(){t.openPopup()})),t.on("click",(function(){t.openPopup()})))},pointToLayer:function(e,t){return L.marker(t,{icon:o})}}).addTo(POIs)},error:function(e,t,a){}})}function getHistorical(){$.ajax({url:"libs/php/getHistorical.php",type:"POST",dataType:"json",data:{countryCode:countryCode},success:function(e){const t=e;let a={type:"FeatureCollection",features:[]};for(i=0;i<t.data.length;i++)a.features.push({type:"Feature",geometry:{type:"Point",coordinates:[t.data[i].lng,t.data[i].lat]},properties:{name:t.data[i].toponymName,countryName:t.data[i].countryName}});a=a.features;var o=L.ExtraMarkers.icon({icon:"fa-monument",extraClasses:"fa-3x",markerColor:"black",shape:"circle",prefix:"fas",shadowSize:[0,0]});L.geoJSON(a,{onEachFeature:function(e,t){e.properties.name&&(t.bindPopup(e.properties.name),t.on("mouseover",(function(){t.openPopup()})),t.on("click",(function(){t.openPopup()})))},pointToLayer:function(e,t){return L.marker(t,{icon:o})}}).addTo(POIs)},error:function(e,t,a){}})}function getWebcams(){$.ajax({url:"libs/php/getWebcams.php",type:"POST",dataType:"json",data:{countryCode:countryCode},success:function(e){const t=e;let a={type:"FeatureCollection",features:[]};for(i=0;i<t.data.webcams.length;i++)a.features.push({type:"Feature",geometry:{type:"Point",coordinates:[t.data.webcams[i].location.longitude,t.data.webcams[i].location.latitude]},properties:{name:t.data.webcams[i].title,countryName:t.data.webcams[i].location.country,dayEmbed:t.data.webcams[i].player.day.embed,thumbnail:t.data.webcams[i].image.current.thumbnail,toenail:t.data.webcams[i].image.current.toenail,icon:t.data.webcams[i].image.current.icon,url:t.data.webcams[i].url.current.desktop}});a=a.features;var o=L.ExtraMarkers.icon({icon:"fa-video",extraClasses:"fa-3x",markerColor:"orange",shape:"circle",prefix:"fas",shadowSize:[0,0]});L.geoJSON(a,{onEachFeature:function(e,t){let a=e.properties.dayEmbed;e.properties.url,e.properties.name,e.properties.dayEmbed&&(t.bindPopup(`<iframe id="miniWebcamFrame" src=${a} title="miniWebcam" allow='autoplay'></iframe>`),t.on("mouseover",(function(){})),t.on("click",(function(){layerControl.collapse(),t.openPopup(),map.panTo(this.getLatLng())})))},pointToLayer:function(e,t){return L.marker(t,{icon:o})}}).addTo(POIs),$("body").on("click",".webcamIcon",(function(){$("#webcamModal").modal("show")}))},error:function(e,t,a){}})}webcams=L.markerClusterGroup({spiderfyOnMaxZoom:!1,showCoverageOnHover:!1,zoomToBoundsOnClick:!0,removeOutsideVisibleBounds:!0,maxClusterRadius:70,iconCreateFunction:function(e){var t=e.getChildCount(),a=" marker-cluster-";return a+=t<10?"small":t<100?"medium":"large",new L.DivIcon({html:"<div><span>"+t+"</span></div>",className:"webcams marker-cluster"+a,iconSize:new L.Point(40,40)})}});const blank=L.tileLayer("https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",maxZoom:20}),satellite=L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"}),labelled=L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",maxZoom:20}),map=L.map("map",{zoomControl:!0}).setView([0,0],2);labelled.addTo(map),L.easyButton("fas fa-location-arrow fa-1x",(function(e,t){navigator.geolocation.getCurrentPosition(onSuccess,onError)}),"Use my location").addTo(map),L.easyButton("fas fa-random fa-1x",(function(e,t){const a=document.getElementById("selCountry"),o=a.getElementsByTagName("option"),n=Math.floor(Math.random()*o.length);a.selectedIndex=n,getLatLng()}),"Random country").addTo(map),L.easyButton("fas fa-info fa-1x",(function(e,t){$("#infoModal").modal("show")}),"Country Info").addTo(map),L.easyButton("fas fa-sun fa-1x",(function(e,t){$("#weatherModal").modal("show")}),"Weather").addTo(map),L.easyButton("fas fa-dollar-sign fa-1x",(function(e,t){$("#financeModal").modal("show")}),"Financial Data").addTo(map),L.easyButton("fas fa-flag fa-1x",(function(e,t){$("#flagModal").modal("show")}),"Flag").addTo(map),L.easyButton("fas fa-music fa-1x",(function(e,t){$("#anthemModal").modal("show")}),"National Anthem").addTo(map),L.easyButton("far fa-newspaper fa-1x",(function(e,t){$("#newsModal").modal("show")}),"Latest Headlines").addTo(map),L.easyButton("fas fa-virus fa-1x",(function(e,t){$("#covidModal").modal("show")}),"Covid-19 Data").addTo(map);const baseMaps={Labelled:labelled,Blank:blank,Satellite:satellite},overlays={POIs:POIs},layerControl=new L.Control.Layers(baseMaps,overlays,{collapsed:!0}).addTo(map);L.control.scale().addTo(map);const popup=L.popup(),capitalPopup=L.popup(),oceanPopup=L.popup(),showModalButton=function(){$("#modalButton").show()},showCheckbox=function(){document.querySelector("#map > div.leaflet-control-container > div.leaflet-top.leaflet-right > div > section > div.leaflet-control-layers-overlays > label:nth-child(5)").css("display","block")},getOcean=function(){$.ajax({url:"libs/php/getOcean.php",type:"POST",dataType:"json",data:{lat:lat,lng:lng},success:function(e){"ok"==e.status.name&&e.data.ocean&&oceanPopup.setLatLng(L.latLng(lat,lng)).setContent(e.data.ocean.name).openOn(map)},error:function(e,t,a){}})},getNeighbours=function(){$.ajax({url:"libs/php/getNeighbours.php",type:"POST",dataType:"json",data:{countryCode:countryCode},success:function(e){if(e.data[1]?$("#neighboursWord").html("Border Neighbours"):$("#neighboursWord").html("Border Neighbour"),e.data[0]){let t=e.data.map((function(e){return e.countryName})).join(", ");$("#neighboursTxt").html(t)}else $("#neighboursWord").html("Border Neighbours"),$("#neighboursTxt").html("None")},error:function(e,t,a){}})},getTime=function(){$.ajax({url:"libs/php/getTime.php",type:"POST",dataType:"json",data:{lat:lat,lng:lng},success:function(e){let t=Date.parse(e.data.time);$("#dateTxt").html(`${t.toString("ddd d MMM")}`),$("#weatherDate").html(`${t.toString("ddd d MMM, HH:mm")}`),$("#timeTxt").html(`${t.toString("HH:mm")}`);let a=t.add(1).days();$("#day2").html(`${a.toString("ddd d")}`);let o=a.add(1).days();$("#day3").html(`${o.toString("ddd d")}`);let n=o.add(1).days();$("#day4").html(`${n.toString("ddd d")}`);n.add(1).days();$("#day5").html(`${n.toString("ddd d")}`)},error:function(e,t,a){}})},getWeather=function(){$.ajax({url:"libs/php/getWeather.php",type:"POST",dataType:"json",data:{lat:lat,lng:lng},success:function(e){let t="https://openweathermap.org/img/wn/"+e.data.current.weather[0].icon+"@4x.png";$("#largeWeatherIcon").attr("src",t);let a=Math.round(e.data.current.temp);$("#currentTemp").html(`${a}&deg;C`),$("#weatherDescription").html(capitalizeFirstLetter(e.data.current.weather[0].description));let o="https://openweathermap.org/img/wn/"+e.data.daily[1].weather[0].icon+"@4x.png";$("#weatherIcon2").attr("src",o);let n="https://openweathermap.org/img/wn/"+e.data.daily[2].weather[0].icon+"@4x.png";$("#weatherIcon3").attr("src",n);let r="https://openweathermap.org/img/wn/"+e.data.daily[3].weather[0].icon+"@4x.png";$("#weatherIcon4").attr("src",r);let c="https://openweathermap.org/img/wn/"+e.data.daily[4].weather[0].icon+"@4x.png";$("#weatherIcon5").attr("src",c),$("#day2Temp").html(`${Math.round(e.data.daily[1].temp.day)}&deg;C`),$("#day3Temp").html(`${Math.round(e.data.daily[2].temp.day)}&deg;C`),$("#day4Temp").html(`${Math.round(e.data.daily[3].temp.day)}&deg;C`),$("#day5Temp").html(`${Math.round(e.data.daily[4].temp.day)}&deg;C`)},error:function(e,t,a){}})},getCityCoords=function(){$.ajax({url:"libs/php/getCityCoords.php",type:"POST",dataType:"json",data:{capital:capital,countryCode:countryCode},success:function(e){lat=e.data.coord.lat,lng=e.data.coord.lon,$.ajax({url:"libs/php/getWeather.php",type:"POST",dataType:"json",data:{lat:lat,lng:lng},success:function(e){let t="https://openweathermap.org/img/wn/"+e.data.current.weather[0].icon+"@4x.png";$("#largeWeatherIcon").attr("src",t);let a=Math.round(e.data.current.temp);$("#currentTemp").html(`${a}&deg;C`),$("#weatherDescription").html(capitalizeFirstLetter(e.data.current.weather[0].description));let o="https://openweathermap.org/img/wn/"+e.data.daily[1].weather[0].icon+"@4x.png";$("#weatherIcon2").attr("src",o);let n="https://openweathermap.org/img/wn/"+e.data.daily[2].weather[0].icon+"@4x.png";$("#weatherIcon3").attr("src",n);let r="https://openweathermap.org/img/wn/"+e.data.daily[3].weather[0].icon+"@4x.png";$("#weatherIcon4").attr("src",r);let c="https://openweathermap.org/img/wn/"+e.data.daily[4].weather[0].icon+"@4x.png";$("#weatherIcon5").attr("src",c),$("#day2Temp").html(`${Math.round(e.data.daily[1].temp.day)}&deg;C`),$("#day3Temp").html(`${Math.round(e.data.daily[2].temp.day)}&deg;C`),$("#day4Temp").html(`${Math.round(e.data.daily[3].temp.day)}&deg;C`),$("#day5Temp").html(`${Math.round(e.data.daily[4].temp.day)}&deg;C`)},error:function(e,t,a){}})},error:function(e,t,a){}})},getIncomeLevel=function(){$.ajax({url:"libs/php/getIncomeLevel.php",type:"POST",dataType:"json",data:{countryCode:countryCode},success:function(e){e.data[1]?$("#incomeLevelTxt").html(e.data[1][0].incomeLevel.value):$("#incomeLevelTxt").html("")},error:function(e,t,a){}})},getNews=function(){$.ajax({url:"libs/php/getNews.php",type:"GET",dataType:"json",data:{countryCode:countryCode,category:$("#selCategory").val(),limit:$("#selLimit").val()},success:function(e){const t=e.data.articles,a=document.getElementById("tbodyNews"),o=document.createDocumentFragment();if(function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(a),0===e.data.totalResults||"error"===e.data.status){const e=document.createElement("tr"),t=document.createElement("td");t.appendChild(document.createTextNode("No headlines available")),e.appendChild(t),o.appendChild(e)}else for(var n=0;n<t.length;n++){const e=document.createElement("tr"),a=document.createElement("td"),r=document.createElement("td"),c=document.createElement("td");a.insertAdjacentHTML("beforeend",`<i class="far fa-clock"></i><br>${fromNow(t[n].publishedAt)}`),r.appendChild(document.createTextNode(t[n].title)),c.insertAdjacentHTML("beforeend",`<a id="readMore1" href=${t[n].url} target="_blank" rel="noopener"><i class="fas fa-long-arrow-alt-right fa-2x"></i></a>`),e.appendChild(a),e.appendChild(r),e.appendChild(c),o.appendChild(e)}a.appendChild(o)},error:function(e,t,a){}})},getAnthem=function(){$.ajax({url:"libs/php/getAnthem.php",type:"POST",dataType:"json",data:{countryAnthem:countryAnthem},success:function(e){"Nepal"===countryAnthem?$("#anthemFrame").attr("src","https://www.youtube.com/embed/cZophCR3rmo"):"Falkland%20Islands"===countryAnthem?$("#anthemFrame").attr("src","https://www.youtube.com/embed/WhIwRMIXzOY"):"New%20Caledonia"===countryAnthem?$("#anthemFrame").attr("src","https://www.youtube.com/embed/Rp4VUo75YS4"):"Western%20Sahara"===countryAnthem?$("#anthemFrame").attr("src","https://www.youtube.com/embed/9z7kpJOp9Qo"):"Uganda"===countryAnthem?$("#anthemFrame").attr("src","https://www.youtube.com/embed/e2ZPUHVUoTw"):$("#anthemFrame").attr("src",`https://www.youtube.com/embed/${e.data[0].id.videoId}`)},error:function(e,t,a){}})};$("#anthemModal").on("hidden.bs.modal",(function(){var e=$(this).html();$(this).html(e)}));const getCovid=function(){$.ajax({url:"libs/php/getCovid.php",type:"POST",dataType:"json",success:function(e){let t=e.data.Countries.filter((e=>e.CountryCode===countryCode));if(t[0]){$("#newCases").html(numberWithCommas(t[0].NewConfirmed)),$("#totalCases").html(numberWithCommas(t[0].TotalConfirmed)),$("#newDeaths").html(numberWithCommas(t[0].NewDeaths)),$("#totalDeaths").html(numberWithCommas(t[0].TotalDeaths));var a=new Date(t[0].Date);$("#covidDate").html(`Updated ${fromNow(a)} ago`)}else $("#newCases").html(""),$("#totalCases").html(""),$("#newDeaths").html(""),$("#totalDeaths").html(""),$("#covidDate").html("")},error:function(e,t,a){}})},getExchangeRate=function(){$.ajax({url:"libs/php/getExchangeRate.php",type:"POST",dataType:"json",data:{baseCurrencyCode:$("#selCurrency").val()},success:function(e){$("#exchangeTxt").html(e.data.rates[currencyCode])},error:function(e,t,a){}})};$.ajax({url:"libs/php/getCurrencyNames.php",type:"POST",dataType:"json",success:function(e){let t=Object.keys(e.data.rates);t=t.filter((function(e){return"EUR"!==e})),t=t.filter((function(e){return"GBP"!==e})),t=t.filter((function(e){return"USD"!==e})),t.forEach((e=>$("#optGroupAll").append(new Option(e,e))))},error:function(e,t,a){}});const getCountryInfo=function(){$.ajax({url:"libs/php/getCountryInfo.php",type:"POST",dataType:"json",data:{countryCode:countryCode},success:function(e){capital=e.data[0].capital;let t=e.data[0].continentName;$("#continentTxt").html(t),"Europe"===t?$("#continentIcon").addClass("fa-globe-europe"):"Asia"===t?$("#continentIcon").addClass("fa-globe-asia"):"North America"===t||"South America"===t?$("#continentIcon").addClass("fa-globe-americas"):"Africa"===t?$("#continentIcon").addClass("fa-globe-africa"):$("#continentIcon").addClass("fa-globe"),$("#areaTxt").html(numberWithCommas(Math.round(e.data[0].areaInSqKm))),$("#populationTxt").html(numberWithCommas(e.data[0].population)),currencyCode=e.data[0].currencyCode;let a=e.data[0].countryCode;var o;$("#ISO2Txt").html(a),$("#ISO3Txt").html(e.data[0].isoAlpha3),countryName=e.data[0].countryName,countryAnthem=replaceWhitespace20(replaceWhitespace20(countryName)),$("#countryName").html(countryName),$("#countryLink").attr("href",`https://en.wikipedia.org/wiki/${o=countryName,o=o.replace(" ","_")}`),$("#covidTitle").html(`${countryName} Covid-19 Data`),$("#flagName").html(countryName),$("#anthemName").html(countryName),getExchangeRate(),getCityCoords(),getCountryBorders(),webcams.remove(),POIs.clearLayers(),webcams.clearLayers(),$.ajax({url:"libs/php/getAnthem.php",type:"POST",dataType:"json",data:{countryAnthem:countryAnthem},success:function(e){"Nepal"===countryAnthem?$("#anthemFrame").attr("src","https://www.youtube.com/embed/cZophCR3rmo"):"Falkland%20Islands"===countryAnthem?$("#anthemFrame").attr("src","https://www.youtube.com/embed/WhIwRMIXzOY"):"New%20Caledonia"===countryAnthem?$("#anthemFrame").attr("src","https://www.youtube.com/embed/Rp4VUo75YS4"):"Western%20Sahara"===countryAnthem?$("#anthemFrame").attr("src","https://www.youtube.com/embed/9z7kpJOp9Qo"):"Uganda"===countryAnthem?$("#anthemFrame").attr("src","https://www.youtube.com/embed/e2ZPUHVUoTw"):$("#anthemFrame").attr("src",`https://www.youtube.com/embed/${e.data[0].id.videoId}`)},error:function(e,t,a){}}),getNews(),getCovid(),getCities(),getStadia(),getAirports(),getParks(),getHistorical(),getWebcams(),document.getElementById("selCategory").selectedIndex=0,POIs.addTo(map),webcams.addTo(map)},error:function(e,t,a){}})},getRestCountries=function(){$.ajax({url:"libs/php/getRestCountries.php",type:"POST",dataType:"json",data:{countryCode:countryCode},success:function(e){$("#capitalTxt").html(e.data[0].capital[0]),$("#weatherCity").html(e.data[0].capital[0]),Object.values(e.data[0].languages).length>1?$("#languageWord").html("Languages"):$("#languageWord").html("Language"),$("#languagesTxt").html(Object.values(e.data[0].languages).join(", ")),e.data[0].demonyms.eng.f===e.data[0].demonyms.eng.m?($("#demonymWord").html("Demonym"),$("#demonymTxt").html(e.data[0].demonyms.eng.f)):($("#demonymWord").html("Demonyms"),$("#demonymTxt").html(Object.values(e.data[0].demonyms.eng).join(", "))),$("#drivesTxt").html(capitalizeFirstLetter(e.data[0].car.side));let t=Object.values(e.data[0].currencies)[0],a=Object.keys(e.data[0].currencies)[0];t.symbol?$("#currencyTxt").html(`${t.name} (${t.symbol}) (${a})`):$("#currencyTxt").html(`${t.name} (${a})`);let o=e.data[0].flags.png;$("#titleFlag").attr("src",o),$("#flag").attr("src",o)},error:function(e,t,a){}})},getCountryCode=function(){$.ajax({url:"libs/php/getCountryCode.php",type:"POST",dataType:"json",data:{lat:lat,lng:lng},success:function(e){"ok"==e.status.name&&e.data.countryCode?setTimeout((function(){countryCode=e.data.countryCode,$("#selCountry").val(countryCode),$.ajax({url:"libs/php/getCountryInfo.php",type:"POST",dataType:"json",data:{countryCode:countryCode},success:function(e){capital=e.data[0].capital;let t=e.data[0].continentName;$("#continentTxt").html(t),"Europe"===t?$("#continentIcon").addClass("fa-globe-europe"):"Asia"===t?$("#continentIcon").addClass("fa-globe-asia"):"North America"===t||"South America"===t?$("#continentIcon").addClass("fa-globe-americas"):"Africa"===t?$("#continentIcon").addClass("fa-globe-africa"):$("#continentIcon").addClass("fa-globe"),$("#areaTxt").html(numberWithCommas(Math.round(e.data[0].areaInSqKm))),$("#populationTxt").html(numberWithCommas(e.data[0].population)),currencyCode=e.data[0].currencyCode;let a=e.data[0].countryCode;var o;$("#ISO2Txt").html(a),$("#ISO3Txt").html(e.data[0].isoAlpha3),countryName=e.data[0].countryName,countryAnthem=replaceWhitespace20(replaceWhitespace20(countryName)),$("#countryName").html(countryName),$("#countryLink").attr("href",`https://en.wikipedia.org/wiki/${o=countryName,o=o.replace(" ","_")}`),$("#covidTitle").html(`${countryName} Covid-19 Data`),$("#flagName").html(countryName),$("#anthemName").html(countryName),getExchangeRate(),getCityCoords(),getCountryBorders(),webcams.remove(),POIs.clearLayers(),webcams.clearLayers(),$.ajax({url:"libs/php/getAnthem.php",type:"POST",dataType:"json",data:{countryAnthem:countryAnthem},success:function(e){"Nepal"===countryAnthem?$("#anthemFrame").attr("src","https://www.youtube.com/embed/cZophCR3rmo"):"Falkland%20Islands"===countryAnthem?$("#anthemFrame").attr("src","https://www.youtube.com/embed/WhIwRMIXzOY"):"New%20Caledonia"===countryAnthem?$("#anthemFrame").attr("src","https://www.youtube.com/embed/Rp4VUo75YS4"):"Western%20Sahara"===countryAnthem?$("#anthemFrame").attr("src","https://www.youtube.com/embed/9z7kpJOp9Qo"):"Uganda"===countryAnthem?$("#anthemFrame").attr("src","https://www.youtube.com/embed/e2ZPUHVUoTw"):$("#anthemFrame").attr("src",`https://www.youtube.com/embed/${e.data[0].id.videoId}`)},error:function(e,t,a){}}),getNews(),getCovid(),getCities(),getStadia(),getAirports(),getParks(),getHistorical(),getWebcams(),document.getElementById("selCategory").selectedIndex=0,POIs.addTo(map),webcams.addTo(map)},error:function(e,t,a){}}),$.ajax({url:"libs/php/getNeighbours.php",type:"POST",dataType:"json",data:{countryCode:countryCode},success:function(e){if(e.data[1]?$("#neighboursWord").html("Border Neighbours"):$("#neighboursWord").html("Border Neighbour"),e.data[0]){let t=e.data.map((function(e){return e.countryName})).join(", ");$("#neighboursTxt").html(t)}else $("#neighboursWord").html("Border Neighbours"),$("#neighboursTxt").html("None")},error:function(e,t,a){}}),$.ajax({url:"libs/php/getIncomeLevel.php",type:"POST",dataType:"json",data:{countryCode:countryCode},success:function(e){e.data[1]?$("#incomeLevelTxt").html(e.data[1][0].incomeLevel.value):$("#incomeLevelTxt").html("")},error:function(e,t,a){}}),$.ajax({url:"libs/php/getTime.php",type:"POST",dataType:"json",data:{lat:lat,lng:lng},success:function(e){let t=Date.parse(e.data.time);$("#dateTxt").html(`${t.toString("ddd d MMM")}`),$("#weatherDate").html(`${t.toString("ddd d MMM, HH:mm")}`),$("#timeTxt").html(`${t.toString("HH:mm")}`);let a=t.add(1).days();$("#day2").html(`${a.toString("ddd d")}`);let o=a.add(1).days();$("#day3").html(`${o.toString("ddd d")}`);let n=o.add(1).days();$("#day4").html(`${n.toString("ddd d")}`),n.add(1).days(),$("#day5").html(`${n.toString("ddd d")}`)},error:function(e,t,a){}}),$.ajax({url:"libs/php/getRestCountries.php",type:"POST",dataType:"json",data:{countryCode:countryCode},success:function(e){$("#capitalTxt").html(e.data[0].capital[0]),$("#weatherCity").html(e.data[0].capital[0]),Object.values(e.data[0].languages).length>1?$("#languageWord").html("Languages"):$("#languageWord").html("Language"),$("#languagesTxt").html(Object.values(e.data[0].languages).join(", ")),e.data[0].demonyms.eng.f===e.data[0].demonyms.eng.m?($("#demonymWord").html("Demonym"),$("#demonymTxt").html(e.data[0].demonyms.eng.f)):($("#demonymWord").html("Demonyms"),$("#demonymTxt").html(Object.values(e.data[0].demonyms.eng).join(", "))),$("#drivesTxt").html(capitalizeFirstLetter(e.data[0].car.side));let t=Object.values(e.data[0].currencies)[0],a=Object.keys(e.data[0].currencies)[0];t.symbol?$("#currencyTxt").html(`${t.name} (${t.symbol}) (${a})`):$("#currencyTxt").html(`${t.name} (${a})`);let o=e.data[0].flags.png;$("#titleFlag").attr("src",o),$("#flag").attr("src",o)},error:function(e,t,a){}})}),0):$.ajax({url:"libs/php/getOcean.php",type:"POST",dataType:"json",data:{lat:lat,lng:lng},success:function(e){"ok"==e.status.name&&e.data.ocean&&oceanPopup.setLatLng(L.latLng(lat,lng)).setContent(e.data.ocean.name).openOn(map)},error:function(e,t,a){}})},error:function(e,t,a){}})},getLatLng=function(){$.ajax({url:"libs/php/getLatLng.php",type:"POST",dataType:"json",data:{countryCode:$("#selCountry").val()},success:function(e){switch($("#selCountry").val()){case"BS":lat=25.066667,lng=-77.333333;break;case"CU":lat=23.136667,lng=-82.358889;break;case"FK":lat=-51.7,lng=-57.85;break;case"FJ":lat=-17.83378025276999,lng=178.023239265527;break;case"VU":lat=-17.733333,lng=168.316667;break;case"TT":lat=10.666667,lng=-61.5075;break;case"PH":lat=14.6,lng=120.98;break;default:lat=e.data.latlng[0],lng=e.data.latlng[1]}setTimeout(getCountryCode,1)},error:function(e,t,a){}})};function onMapClick(e){lat=e.latlng.lat,lng=e.latlng.lng,setTimeout(getCountryCode,1)}$("#selCountry").change((function(){getLatLng()})),$("#selCurrency").change((function(){getExchangeRate()})),map.on("click",onMapClick);const refreshPage=()=>{location.reload()};function fromNow(e){e=Date.parse(e);var t=Math.floor((new Date-e)/1e3),a=Math.floor(t/31536e3),o=Math.floor(t/2592e3),n=Math.floor(t/86400);if(n>548)return a+"y";if(n>=320&&n<=547)return"1y";if(n>=45&&n<=319)return o+"m";if(n>=26&&n<=45)return"1m";var r=Math.floor(t/3600);if(r>=36&&n<=25)return n+"d";if(r>=22&&r<=35)return"1d";var c=Math.floor(t/60);return c>=90&&r<=21?r+"h":c>=45&&c<=89?"1h":t>=90&&c<=44?c+" mins":t>=45&&t<=89?"1 min":t>=0&&t<=45?"a few seconds ago":void 0}$(".navbar-brand").click(refreshPage),$("#selCategory").on("change",(function(){getNews()})),$("#selLimit").on("change",(function(){getNews()})),$("#newsModal").on("shown.bs.modal",(function(){$("#newsModal").scrollTop(0)}));